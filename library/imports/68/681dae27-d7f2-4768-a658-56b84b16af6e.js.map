{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\AudioMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\nexport default class AudioMgr {\r\n    bgmVolume: number = 0.5;\r\n    sfxVolume: number = 0.3;\r\n    bgmAudioID: number = 0;\r\n    //背景音乐播放的时间\r\n    bgmCurrentTime = 0\r\n    //最大播放音乐数量\r\n    //TODO  后边放到编辑器里初始化\r\n    MAX_AUDIO_NUM: number = 10;\r\n    constructor() {\r\n        const bgm = cc.sys.localStorage.getItem(\"bgmVolume\");\r\n        if (bgm != null) {\r\n            this.bgmVolume = parseFloat(bgm);\r\n        }\r\n        const sfx = cc.sys.localStorage.getItem(\"sfxVolume\");\r\n        if (sfx != null) {\r\n            this.sfxVolume = parseFloat(sfx);\r\n        }\r\n\r\n        cc.audioEngine.setMaxAudioInstance(this.MAX_AUDIO_NUM);\r\n\r\n    }\r\n\r\n    init() {\r\n        let self = this;\r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            console.log(\"cc.audioEngine.pauseAll1\");\r\n            self.pauseAll();\r\n        });\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            console.log(\"cc.audioEngine.resumeAll2\");\r\n            // cc.audioEngine.resumeAll();\r\n            self.resumeAll();\r\n        });\r\n    }\r\n\r\n    getUrl(url) {\r\n        cc.log(url);\r\n        return cc.url.raw(\"resources/audio/effectAudio/\" + url);\r\n    }\r\n\r\n    playBGM(url) {\r\n        const audioUrl = this.getUrl(url);\r\n        cc.log(audioUrl);\r\n        if (this.bgmAudioID >= 0) {\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n        }\r\n        this.bgmAudioID = cc.audioEngine.play(audioUrl, true, this.bgmVolume);\r\n    }\r\n\r\n\r\n    StopBGM() {\r\n        cc.audioEngine.stop(this.bgmAudioID);\r\n    }\r\n\r\n    playSFX(url) {\r\n        if (this.sfxVolume > 0) {\r\n            const audioUrl = this.getUrl(url);\r\n            cc.audioEngine.play(audioUrl, false, this.sfxVolume);\r\n        }\r\n    }\r\n\r\n    setSFXVolume(v) {\r\n        if (this.sfxVolume != v) {\r\n            cc.sys.localStorage.setItem(\"sfxVolume\", v);\r\n            this.sfxVolume = v;\r\n        }\r\n    }\r\n\r\n    setBGMVolume(v) {\r\n        if (this.bgmAudioID >= 0) {\r\n            if (v > 0) {\r\n                cc.audioEngine.resume(this.bgmAudioID);\r\n            } else {\r\n                cc.audioEngine.pause(this.bgmAudioID);\r\n            }\r\n        }\r\n        if (this.bgmVolume != v) {\r\n            cc.sys.localStorage.setItem(\"bgmVolume\", v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgmAudioID, v);\r\n        }\r\n    }\r\n\r\n    pauseAll(): void {\r\n        if (this.bgmAudioID > 0) {\r\n            this.bgmCurrentTime = cc.audioEngine.getCurrentTime(this.bgmAudioID);\r\n        }\r\n        cc.audioEngine.pauseAll();\r\n        // this.clearAll();\r\n    }\r\n\r\n    resumeAll(): void {\r\n        cc.audioEngine.resumeAll();\r\n        if (this.bgmVolume > 0 && this.bgmAudioID > 0) {\r\n            // cc.audioEngine.resume(this.bgmAudioID);\r\n            // cc.audioEngine.resumeAll();\r\n            // this.bgmAudioID = cc.audioEngine.play(this.currentBGMUrl, true, this.bgmVolume);\r\n            cc.audioEngine.setCurrentTime(this.bgmAudioID, this.bgmCurrentTime);\r\n        }\r\n    }\r\n}\r\n"]}