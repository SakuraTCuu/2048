__require=function e(t,o,i){function n(a,c){if(!o[a]){if(!t[a]){var u=a.split("/");if(u=u[u.length-1],!t[u]){var s="function"==typeof __require&&__require;if(!c&&s)return s(u,!0);if(r)return r(u,!0);throw new Error("Cannot find module '"+a+"'")}}var l=o[a]={exports:{}};t[a][0].call(l.exports,function(e){return n(t[a][1][e]||e)},l,l.exports,e,t,o,i)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)n(i[a]);return n}({AudioMgr:[function(e,t,o){"use strict";cc._RF.push(t,"681da4n1/JHaKZYVrhLFq9u","AudioMgr"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./GameManager"),n=function(){function e(){}return e.init=function(){cc.audioEngine.setMaxAudioInstance(e.MAX_AUDIO_NUM)},e.getUrl=function(e){return cc.url.raw("resources/audio/effectAudio/"+e)},e.playBGM=function(t){e.audioUrl=t;var o=e.getUrl(t);e.bgmAudioID>=0&&cc.audioEngine.stop(e.bgmAudioID),e.bgmAudioID=cc.audioEngine.play(o,!0,e.bgmVolume)},e.StopBGM=function(){cc.audioEngine.pause(e.bgmAudioID)},e.playSFX=function(t){if(e.sfxVolume>0){var o=e.getUrl(t);cc.audioEngine.play(o,!1,e.sfxVolume)}},e.setSFXVolume=function(t){e.sfxVolume!=t&&(cc.sys.localStorage.setItem("sfxVolume",t),e.sfxVolume=t)},e.setBGMVolume=function(t){e.bgmAudioID>=0&&(t>0?cc.audioEngine.resume(e.bgmAudioID):cc.audioEngine.pause(e.bgmAudioID)),e.bgmVolume!=t&&(cc.sys.localStorage.setItem("bgmVolume",t),e.bgmVolume=t,cc.audioEngine.setVolume(e.bgmAudioID,t))},e.pauseAll=function(){cc.audioEngine.stopAll()},e.resumeAll=function(){cc.audioEngine.stopAll(),i.default.gameState==i.GameState.Hall&&""!=e.audioUrl&&e.playBGM(e.audioUrl)},e.bgmVolume=1,e.sfxVolume=1,e.bgmAudioID=0,e.bgmCurrentTime=0,e.MAX_AUDIO_NUM=10,e.audioUrl="",e}();o.default=n,cc._RF.pop()},{"./GameManager":"GameManager"}],GameManager:[function(e,t,o){"use strict";var i;cc._RF.push(t,"10c533gBTdBPaB+dQQqOuwf","GameManager"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Hall=0]="Hall",e[e.Game=1]="Game"}(i=o.GameState||(o.GameState={}));var n=function(){function e(){}return e.gameState=i.Hall,e}();o.default=n,cc._RF.pop()},{}],GameUtils:[function(e,t,o){"use strict";cc._RF.push(t,"e1313dDnstBzayNAmy4j035","GameUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){}return e.popTips=function(e,t){var o=new cc.Node,i=o.addComponent(cc.Label);o.addComponent(cc.LabelOutline).width=1.5,i.string=t,i.fontSize=40,e.addChild(o),o.setPosition(0,-200);var n=cc.moveBy(.5,0,200),r=cc.fadeTo(.5,0),a=cc.callFunc(function(){var e=cc.spawn(n,r),t=cc.sequence(e,cc.callFunc(function(){o.active=!1,o.removeFromParent(),o.destroy()}));o.runAction(t)}),c=cc.sequence(n,cc.delayTime(.8),a);o.runAction(c)},e.showText=function(e){},e}();o.default=i,cc._RF.pop()},{}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"64b8176Jz1ACbR6ZTDH7KkE","Game"),Object.defineProperty(o,"__esModule",{value:!0});var i,n,r=e("./Item"),a=e("./AudioMgr"),c=e("./GameManager"),u=cc._decorator,s=u.ccclass,l=u.property;(function(e){e[e.LeftRight=1]="LeftRight",e[e.UpDown=2]="UpDown"})(i=o.slideDirection||(o.slideDirection={})),function(e){e[e.left=0]="left",e[e.right=1]="right",e[e.up=2]="up",e[e.down=3]="down"}(n=o.direction||(o.direction={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numberAtlas=null,t.squareItem=null,t.content=null,t.effectNode=null,t.gameOverPrefab=null,t.exitGameNode=null,t._pos=null,t._endPos=null,t._startPos=null,t._cancelPos=null,t._score=0,t._step=0,t._mergeStep=0,t.squareNum=4,t._sqrt=null,t._sqrt2=null,t._direction=n.left,t._slide=i.LeftRight,t._armature=null,t._isMerge=!1,t._audioID=-1,t._clickFlag=!0,t._gameState=!0,t}var o;return __extends(t,e),o=t,Object.defineProperty(t,"instance",{get:function(){return o._instance},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){c.default.gameState=c.GameState.Hall,o._instance=this,this.initGame(),this.content.width=this._sqrt[0][0].width*this.squareNum+20*(this.squareNum+1),this.content.height=this._sqrt[0][0].height*this.squareNum+20*(this.squareNum+1),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.initEffect()},t.prototype.onReturnHall=function(){cc.director.loadScene("Hall")},t.prototype.onClickExitBtn=function(){this.exitGameNode.active=!0},t.prototype.onClickMusic=function(e){var t=e.target,o=t.getChildByName("on"),i=t.getChildByName("off");o.active?(a.default.setSFXVolume(0),o.active=!1,i.active=!0):(a.default.setSFXVolume(1),o.active=!0,i.active=!1)},t.prototype.initEffect=function(){var e=this.effectNode.getComponent(dragonBones.ArmatureDisplay);this._armature=e.armature()},t.prototype.setEffectNode=function(e){this._armature.animation.fadeIn(e,-1,-1,0,"normal")},t.prototype.setEffectName=function(e){var t="";switch(e){case 8:t="dbgood";break;case 9:t="dbgreat";break;case 10:t="dbperfect";break;case 11:t="dbunbele";break;case 12:t="damazing"}""==t||this.setEffectNode(t)},t.prototype.playAudioEffect=function(){if(this._audioID>12)return this._audioID=-1,void cc.log("\u4f60\u592a\u725b\u903c\u4e86..\u8fde\u950012\u4e2a..\u5389\u5bb3\u4e86\uff0c\u4ece0\u7ee7\u7eed\u5427");this._audioID<=0||(this.setEffectName(this._audioID),a.default.playSFX("audio"+this._audioID+".ogg"),this._mergeStep++)},t.prototype.initGame=function(){var e=this;this._sqrt=new Array,this._sqrt2=new Array;for(var t=0;t<this.squareNum;t++)this._sqrt2[t]=new Array;for(t=0;t<this.squareNum;t++){this._sqrt[t]=new Array;for(var o=0;o<this.squareNum;o++){var i=cc.instantiate(this.squareItem);i.name=t+""+o,this._sqrt[t][o]=i,this._sqrt2[o][t]=i,this.content.addChild(i),this.initPos(i,t,o)}}this.scheduleOnce(function(){e.initGrid()},.2)},t.prototype.initPos=function(e,t,o){var i=e.width*o+e.width/2+20*(o+1),n=e.height*t+e.width/2+20*(t+1)+20;e.position=cc.v2(i,-n)},t.prototype.initGrid=function(){var e=this.randomLocation(),t=this.randomLocation(),o=this.randomNumber(),i=this.randomNumber(),n=this.content.getChildByName(e.l+""+e.r),a=this.content.getChildByName(t.l+""+t.r);n.getComponent(r.default).showNumber(o,!0),a.getComponent(r.default).showNumber(i,!0)},t.prototype.setLabInfo=function(){},t.prototype.everyTimeMoveCallback=function(){a.default.playSFX("move.ogg")},t.prototype.everyTimeEndCallback=function(){},t.prototype.everyTimeMergeCallBack=function(){},t.prototype.touchEnd=function(e){if(this._clickFlag){this._clickFlag=!1;var t=e.getLocation();this._endPos=cc.v2(t.x,t.y),this.everyTimeMoveCallback(),this.checkSlideDirection(this._endPos),this._step++,this.setLabInfo()}},t.prototype.touchStart=function(e){var t=e.getLocation();this._startPos=cc.v2(t.x,t.y)},t.prototype.touchCancel=function(e){if(this._clickFlag){this._clickFlag=!1;var t=e.getLocation();this._cancelPos=cc.v2(t.x,t.y),this.everyTimeMoveCallback(),this.checkSlideDirection(this._cancelPos),this._step++,this.setLabInfo()}},t.prototype.checkSlideDirection=function(e){var t=cc.pSub(this._startPos,e),o=cc.pToAngle(t),r=cc.radiansToDegrees(o);this._slide=r>=45&&r<=135||r<=-45&&r>=-135?i.UpDown:i.LeftRight,this._slide==i.LeftRight?(this._startPos.x>e.x&&(this._direction=n.left),this._startPos.x<e.x&&(this._direction=n.right)):(this._startPos.y>e.y&&(this._direction=n.down),this._startPos.y<e.y&&(this._direction=n.up)),this.slideSquare()},t.prototype.slideSquare=function(){var e=this;this.moveSqrt(),this.everyTimeEndCallback(),this._isMerge?(this._audioID++,this.playAudioEffect(),this.everyTimeMergeCallBack()):this._audioID=0,this._isMerge=!1,this.scheduleOnce(function(){if(e.randomSqrtInNULL(),e.checkGameOver()&&e._gameState)return e._gameState=!1,cc.log("\u6e38\u620f\u7ed3\u675f"),e.gameOver(),void(e._clickFlag=!0)},.2)},t.prototype.gameOver=function(){var e=cc.instantiate(this.gameOverPrefab);this.node.addChild(e),e.scale=0;var t=e.getChildByName("mask");t.active=!1,e.zIndex=99;var o=cc.scaleTo(.3,1).easing(cc.easeOut(3)),i=cc.sequence(o,cc.callFunc(function(){t.active=!0}));e.runAction(i)},t.prototype.checkGameOver=function(){for(var e=this.content.childrenCount,t=!0,o=0;o<e;o++){this.content.children[o].getComponent(r.default).isNum()||(t=!1)}t&&(this.checkGameOverAllMerge()&&(t=!1));return t},t.prototype.moveSqrt=function(){for(var e=0;e<this.squareNum;e++)this.calcSlidePosition(e)},t.prototype.calcSlidePosition=function(e){var t,o=new Array;if(t=this._slide==i.LeftRight?this._sqrt[e]:this._sqrt2[e],this._direction==n.left||this._direction==n.up)for(var a=0;a<t.length;a++){t[a].getComponent(r.default).isNum()&&o.push(a)}else for(a=t.length-1;a>=0;a--){t[a].getComponent(r.default).isNum()&&o.push(a)}var c=0;if(this._direction==n.left||this._direction==n.up)for(a=0;a<o.length;a++){var u=null,s=null;u=t[o[a]],s=t[a];var l=u.getComponent(r.default).getNum();if(s.name=l+"",u.getComponent(r.default).setHideNum(l),a>0)if(t[o[a-1]])t[o[a-1]].getComponent(r.default).getHideNum()==(d=u.getComponent(r.default).getHideNum())&&0!=d?(s=t[a-1-c],u.getComponent(r.default).setHideNum(0),s.name=2*l+"",c++,this._isMerge=!0):(s=t[a-c]).name=l+"";this.positionMoveAction(u,s,l)}else for(a=0;a<o.length;a++){u=null,s=null;u=t[o[a]],s=t[t.length-a-1];var d;l=u.getComponent(r.default).getNum();if(s.name=l+"",u.getComponent(r.default).setHideNum(l),a>0)if(t[o[a-1]])t[o[a-1]].getComponent(r.default).getHideNum()==(d=u.getComponent(r.default).getHideNum())&&0!=d?(s=t[t.length-a+c],u.getComponent(r.default).setHideNum(0),s.name=2*l+"",c++,this._isMerge=!0):(s=t[t.length-a+c-1]).name=l+"";this.positionMoveAction(u,s,l)}},t.prototype.checkGameOverAllMerge=function(){for(var e=0;e<this.squareNum;e++)for(var t=0;t<this.squareNum;t++){if(t<this.squareNum-1)if(this.checkTwoCanBeMerge(this._sqrt[e][t],this._sqrt[e][t+1]))return!0;if(t<this.squareNum-1)if(this.checkTwoCanBeMerge(this._sqrt[e][this.squareNum-t-1],this._sqrt[e][this.squareNum-t-2]))return!0;if(t<this.squareNum-1)if(this.checkTwoCanBeMerge(this._sqrt2[e][t],this._sqrt2[e][t+1]))return!0;if(t<this.squareNum-1)if(this.checkTwoCanBeMerge(this._sqrt2[e][this.squareNum-t-1],this._sqrt2[e][this.squareNum-t-2]))return!0}return!1},t.prototype.randomSqrtInNULL=function(){for(var e=this.content.childrenCount,t=new Array,o=0;o<e;o++){var i=this.content.children[o];i.getComponent(r.default).isNum()||t.push(i)}var n=Math.floor(Math.random()*t.length),a=this.randomNumber();0!=t.length?(t[n].getComponent(r.default).showNumber(a,!0),this._clickFlag=!0):this._clickFlag=!0},t.prototype.randomNumber=function(){return Math.random()<.8?2:4},t.prototype.randomLocation=function(){return{l:Math.floor(Math.random()*this.squareNum),r:Math.floor(Math.random()*this.squareNum)}},t.prototype.checkTwoCanBeMerge=function(e,t){var o=e.getComponent(r.default),i=t.getComponent(r.default),n=o.isNum(),a=i.isNum();return n&&a?o.getNum()==i.getNum():!(n||!a)},t.prototype.checkTwoMerge=function(e,t){var o=e.getComponent(r.default),i=t.getComponent(r.default),n=o.isNum(),a=i.isNum();if(!n||!a){if(!n&&a){var c=i.getNum();return o.showNumber(c),i.showNumber(0),!0}return!1}var u=o.getNum(),s=i.getNum();return u==s&&(o.showNumber(2*u),i.showNumber(0),t.name=2*s+"",this._score+=u,cc.log("\u5408\u5e76\u4e24\u4e2a---\x3e>>"),o.playParticle(),!0)},t.prototype.positionMoveAction=function(e,t,o){var n=this;e.getComponent(r.default).showNumber(0);var a=cc.instantiate(this.squareItem);a.getComponent(r.default).showNumber(o),a.position=e.position,this.content.addChild(a),this._slide==i.LeftRight?Math.floor(Math.abs(e.x-t.x)/a.height):Math.floor(Math.abs(e.y-t.y)/a.height);var c=cc.moveTo(.2,t.position);a.runAction(cc.sequence(c,cc.callFunc(function(){t.isMerge?(t.getComponent(r.default).showNumber(Number(t.name),!0),t.isMerge=!1):t.getComponent(r.default).showNumber(Number(t.name)),n.content.removeChild(a),a.removeFromParent(),a.destroy()})))},t.prototype.reSetGame=function(){this.content.removeAllChildren(),this._sqrt=null,this._sqrt2=null,this._score=0,this._step=0,this._clickFlag=!0,this._gameState=!0,this.initGame(),this.setEffectNode("dbkaishi")},t.prototype.returnToHall=function(){cc.director.loadScene("main")},t._instance=null,__decorate([l(cc.SpriteAtlas)],t.prototype,"numberAtlas",void 0),__decorate([l(cc.Prefab)],t.prototype,"squareItem",void 0),__decorate([l(cc.Node)],t.prototype,"content",void 0),__decorate([l(cc.Node)],t.prototype,"effectNode",void 0),__decorate([l(cc.Prefab)],t.prototype,"gameOverPrefab",void 0),__decorate([l(cc.Node)],t.prototype,"exitGameNode",void 0),t=o=__decorate([s],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./AudioMgr":"AudioMgr","./GameManager":"GameManager","./Item":"Item"}],Hall:[function(e,t,o){"use strict";cc._RF.push(t,"e1b90/rohdEk4SdmmEZANaD","Hall"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./AudioMgr"),n=e("./GameManager"),r=e("./GameUtils"),a=cc._decorator,c=a.ccclass,u=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.helpNode=null,t.hallNode=null,t.loadingNode=null,t.musicNode=null,t._preTime=null,t}return __extends(t,e),t.prototype.onLoad=function(){if(n.default.gameState=n.GameState.Hall,i.default.init(),i.default.playBGM("BGM.mp3"),0==i.default.bgmVolume){var e=this.musicNode.getChildByName("on"),t=this.musicNode.getChildByName("off");e.active=!1,t.active=!0}},t.prototype.onClickStart=function(){var e=this;this.hallNode.active=!1,this.loadingNode.active=!0,cc.director.preloadScene("main",function(){e.scheduleOnce(function(){i.default.StopBGM(),cc.director.loadScene("main")},2.5)})},t.prototype.onClickHelp=function(){var e=this.node.getChildByName("help");e?e.active=!0:(e=cc.instantiate(this.helpNode),this.node.addChild(e)),e.getChildByName("close").on(cc.Node.EventType.TOUCH_END,function(){e.active=!1},this)},t.prototype.onClickMusic=function(e){var t=e.target,o=t.getChildByName("on"),n=t.getChildByName("off");o.active?(i.default.setBGMVolume(0),o.active=!1,n.active=!0):(i.default.setBGMVolume(1),o.active=!0,n.active=!1)},t.prototype.onClickMoreGame=function(){var e=Date.now();e-this._preTime<=1500||(this._preTime=e,cc.sys.platform,cc.sys.WECHAT_GAME,r.default.popTips(this.node.getChildByName("popLayer"),"\u529f\u80fd\u6682\u672a\u5f00\u653e"))},__decorate([u(cc.Prefab)],t.prototype,"helpNode",void 0),__decorate([u(cc.Node)],t.prototype,"hallNode",void 0),__decorate([u(cc.Node)],t.prototype,"loadingNode",void 0),__decorate([u(cc.Node)],t.prototype,"musicNode",void 0),t=__decorate([c],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./AudioMgr":"AudioMgr","./GameManager":"GameManager","./GameUtils":"GameUtils"}],Item:[function(e,t,o){"use strict";cc._RF.push(t,"cc31aqQf7VFCKZEvefOS9Xs","Item"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Game"),n=cc._decorator,r=n.ccclass,a=n.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.numberSp=null,t.bg=null,t.particleNode=null,t._num=0,t.hideNum=0,t}return __extends(t,e),t.prototype.showNumber=function(e,t){if(void 0===t&&(t=!1),this._num=e,0==e)return this.bg.active=!0,void(this.numberSp.spriteFrame=null);var o=i.default.instance.numberAtlas;if(this.numberSp.spriteFrame=o.getSpriteFrame(e+""),t){this.numberSp.node.scale=.5;var n=cc.scaleTo(.1,1);this.numberSp.node.runAction(n)}},t.prototype.playParticle=function(){var e=this;cc.log("\u64ad\u653e\u7279\u6548"),this.particleNode.node.active=!0,this.particleNode.resetSystem(),this.particleNode.enabled=!0,this.scheduleOnce(function(){e.particleNode.stopSystem(),e.particleNode.enabled=!1},.5)},t.prototype.isNum=function(){return 0!=this._num},t.prototype.getNum=function(){return this._num},t.prototype.setHideNum=function(e){this.hideNum=e},t.prototype.getHideNum=function(){return this.hideNum},__decorate([a(cc.Sprite)],t.prototype,"numberSp",void 0),__decorate([a(cc.Node)],t.prototype,"bg",void 0),__decorate([a(cc.ParticleSystem)],t.prototype,"particleNode",void 0),t=__decorate([r],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./Game":"Game"}],popUI:[function(e,t,o){"use strict";cc._RF.push(t,"7e709htMu9Jprckv8KBkHzG","popUI"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Game"),n=cc._decorator,r=n.ccclass,a=(n.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onResetGame=function(){i.default.instance.reSetGame(),this.onCloseBtn()},t.prototype.onReturnHall=function(){i.default.instance.onReturnHall()},t.prototype.onContinueGame=function(){this.onCloseBtn()},t.prototype.onCloseBtn=function(){this.node.active=!1},t=__decorate([r],t)}(cc.Component));o.default=a,cc._RF.pop()},{"./Game":"Game"}]},{},["AudioMgr","Game","GameManager","GameUtils","Hall","Item","popUI"]);